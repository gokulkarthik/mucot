You are adding a <class 'engine.EvaluationCallback'> to the callbacks of this Trainer, but there is already one. The currentlist of callbacks is
:DefaultFlowCallback
WandbCallback
EarlyStoppingCallback
EvaluationCallback
/home/gokul.kumar/.conda/envs/mlqa/lib/python3.9/site-packages/transformers/optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use thePyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
***** Running training *****
  Num examples = 565
  Num Epochs = 3
  Instantaneous batch size per device = 4
  Total train batch size (w. parallel, distributed & accumulation) = 32
  Gradient Accumulation steps = 8
  Total optimization steps = 51
Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"








 18%|█████████████████████████████████████████████▎                                                                                                                                                                                                                   | 9/51 [00:15<01:04,  1.54s/it]
 20%|██████████████████████████████████████████████████▏                                                                                                                                                                                                             | 10/51 [00:17<01:07,  1.65s/it]***** Running Evaluation *****
  Num examples = 512
  Batch size = 4



PyTorch: setting up devices████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:08<00:00, 13.53it/s]
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
The following columns in the test set  don't have a corresponding argument in `BertForQuestionAnswering.forward` and have been ignored: offset_mapping, example_id.
***** Running Prediction *****
  Num examples = 565
  Batch size = 8
{'eval_loss': 5.5374860763549805, 'eval_runtime': 8.9588, 'eval_samples_per_second': 57.151, 'eval_steps_per_second': 14.288, 'epoch': 0.56}



 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 70/71 [00:09<00:00,  6.63it/s]
 13%|██████████████████████████████████▎                                                                                                                                                                                                                              | 4/30 [00:00<00:00, 28.69it/s]
Post-processing 30 example predictions split into 565 features.
PyTorch: setting up devices█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍        | 29/30 [00:01<00:00, 19.30it/s]
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
The following columns in the test set  don't have a corresponding argument in `BertForQuestionAnswering.forward` and have been ignored: offset_mapping, example_id.
***** Running Prediction *****
  Num examples = 512
  Batch size = 8





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:09<00:00,  6.78it/s]
Post-processing 30 example predictions split into 512 features.
{'jaccard_score': 0.010666666666666666, 'f1_score': 0.018390804597701146}








 37%|███████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                                | 19/51 [01:09<01:25,  2.67s/it]
 39%|████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                                           | 20/51 [01:10<01:14,  2.41s/it]***** Running Evaluation *****
  Num examples = 512
  Batch size = 4




 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████      | 125/128 [00:09<00:00, 12.93it/s]
PyTorch: setting up devices████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:09<00:00, 13.07it/s]
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
The following columns in the test set  don't have a corresponding argument in `BertForQuestionAnswering.forward` and have been ignored: offset_mapping, example_id.
***** Running Prediction *****
  Num examples = 565
  Batch size = 8




 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 70/71 [00:09<00:00, 11.68it/s]
No `TrainingArguments` passed, using `output_dir=tmp_trainer`.███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 70/71 [00:09<00:00, 11.68it/s]
PyTorch: setting up devices██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 21.87it/s]
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
The following columns in the test set  don't have a corresponding argument in `BertForQuestionAnswering.forward` and have been ignored: offset_mapping, example_id.
***** Running Prediction *****
  Num examples = 512
  Batch size = 8
  3%|████████                                                                                                                                                                                                                                                         | 2/64 [00:00<00:04, 12.87it/s]




 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                    | 59/64 [00:07<00:00,  6.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:08<00:00,  6.92it/s]
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                      | 18/30 [00:00<00:00, 30.67it/s]
{'jaccard_score': 0.0044444444444444444, 'f1_score': 0.008888888888888889}








 57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                              | 29/51 [02:00<00:54,  2.49s/it]
 59%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                         | 30/51 [02:02<00:47,  2.28s/it]***** Running Evaluation *****
  Num examples = 512
  Batch size = 4




 93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                 | 119/128 [00:08<00:00, 13.37it/s]
PyTorch: setting up devices████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:09<00:00, 12.90it/s]
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
The following columns in the test set  don't have a corresponding argument in `BertForQuestionAnswering.forward` and have been ignored: offset_mapping, example_id.
***** Running Prediction *****
  Num examples = 565
  Batch size = 8




 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 70/71 [00:10<00:00,  6.64it/s]
  0%|                                                                                                                                                                                                                                                                         | 0/30 [00:00<?, ?it/s]
PyTorch: setting up devices██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 22.09it/s]
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
The following columns in the test set  don't have a corresponding argument in `BertForQuestionAnswering.forward` and have been ignored: offset_mapping, example_id.
***** Running Prediction *****
  Num examples = 512
  Batch size = 8
  6%|████████████████                                                                                                                                                                                                                                                 | 4/64 [00:00<00:06,  8.88it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:09<00:00,  6.93it/s]
  0%|                                                                                                                                                                                                                                                                         | 0/30 [00:00<?, ?it/s]
Post-processing 30 example predictions split into 512 features.
{'jaccard_score': 0.0, 'f1_score': 0.0}









 78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                       | 40/51 [02:54<00:24,  2.22s/it]***** Running Evaluation *****
  Num examples = 512
  Batch size = 4
  2%|██████                                                                                                                                                                                                                                                          | 3/128 [00:00<00:06, 19.94it/s]




 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 124/128 [00:08<00:00, 13.54it/s]
PyTorch: setting up devices████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:08<00:00, 13.34it/s]
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
The following columns in the test set  don't have a corresponding argument in `BertForQuestionAnswering.forward` and have been ignored: offset_mapping, example_id.
***** Running Prediction *****
  Num examples = 565
  Batch size = 8




 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 70/71 [00:10<00:00,  6.45it/s]
 43%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                                                                 | 13/30 [00:00<00:00, 21.43it/s]
Post-processing 30 example predictions split into 565 features.
PyTorch: setting up devices██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 21.75it/s]
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
The following columns in the test set  don't have a corresponding argument in `BertForQuestionAnswering.forward` and have been ignored: offset_mapping, example_id.
***** Running Prediction *****
  Num examples = 512
  Batch size = 8




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:09<00:00,  6.46it/s]
 67%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                     | 20/30 [00:00<00:00, 29.63it/s]
Post-processing 30 example predictions split into 512 features.
{'jaccard_score': 0.0, 'f1_score': 0.0}









 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉          | 49/51 [03:45<00:05,  2.89s/it]
 98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉     | 50/51 [03:47<00:02,  2.56s/it]***** Running Evaluation *****
  Batch size = 4 512
  Batch size = 4 512
 40%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                                                         | 51/128 [00:03<00:06, 12.65it/s]
 60%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 77/128 [00:05<00:03, 13.07it/s]
 82%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                             | 105/128 [00:07<00:01, 13.46it/s]
***** Running Prediction *****█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:09<00:00, 12.91it/s]
***** Running Prediction *****█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:09<00:00, 12.91it/s]
{'eval_loss': 4.104129791259766, 'eval_runtime': 9.8166, 'eval_samples_per_second': 52.157, 'eval_steps_per_second': 13.039, 'epoch': 2.9}
***** Running Prediction *****█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:09<00:00, 12.91it/s]
***** Running Prediction *****█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:09<00:00, 12.91it/s]
***** Running Prediction *****█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:09<00:00, 12.91it/s]
 23%|███████████████████████████████████████████████████████████▉                                                                                                                                                                                                     | 7/30 [00:00<00:01, 18.37it/s]
 23%|███████████████████████████████████████████████████████████▉                                                                                                                                                                                                     | 7/30 [00:00<00:01, 18.37it/s]
***** Running Prediction *****███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 19.35it/s]
***** Running Prediction *****███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 19.35it/s]
{'jaccard_score': 0.0, 'f1_score': 0.0}
***** Running Prediction *****███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 19.35it/s]
***** Running Prediction *****███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 19.35it/s]
***** Running Prediction *****███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 19.35it/s]
***** Running Prediction *****███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 19.35it/s]
 73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 22/30 [00:01<00:00, 18.09it/s]
 73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 22/30 [00:01<00:00, 18.09it/s]
{'jaccard_score': 0.0, 'f1_score': 0.0}

{'jaccard_score': 0.0, 'f1_score': 0.0}
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [04:21<00:00, 12.06s/it]
 19%|████████████████████████████████████████████████                                                                                                                                                                                                                | 12/64 [00:01<00:07,  6.55it/s]
Training completed. Do not forget to share your model on huggingface.co/models =)
 19%|████████████████████████████████████████████████                                                                                                                                                                                                                | 12/64 [00:01<00:07,  6.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [04:21<00:00,  5.13s/it]
No `TrainingArguments` passed, using `output_dir=tmp_trainer`.
 19%|████████████████████████████████████████████████                                                                                                                                                                                                                | 12/64 [00:01<00:07,  6.55it/s]
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
The following columns in the test set  don't have a corresponding argument in `BertForQuestionAnswering.forward` and have been ignored: offset_mapping, example_id.
 19%|████████████████████████████████████████████████                                                                                                                                                                                                                | 12/64 [00:01<00:07,  6.55it/s]
  Num examples = 512
  Batch size = 8
 19%|████████████████████████████████████████████████                                                                                                                                                                                                                | 12/64 [00:01<00:07,  6.55it/s]
 19%|████████████████████████████████████████████████                                                                                                                                                                                                                | 12/64 [00:01<00:07,  6.55it/s]
 19%|████████████████████████████████████████████████                                                                                                                                                                                                                | 12/64 [00:01<00:07,  6.55it/s]
 19%|████████████████████████████████████████████████                                                                                                                                                                                                                | 12/64 [00:01<00:07,  6.55it/s]
 19%|████████████████████████████████████████████████                                                                                                                                                                                                                | 12/64 [00:01<00:07,  6.55it/s]
 19%|████████████████████████████████████████████████                                                                                                                                                                                                                | 12/64 [00:01<00:07,  6.55it/s]
 39%|████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                            | 25/64 [00:03<00:05,  6.51it/s]
 61%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 39/64 [00:05<00:03,  6.66it/s]
 81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                | 52/64 [00:07<00:01,  6.64it/s]
KeyError: 'f3e4ced27'tprocess_qa_predictions(dataset, dataset_tokenized, main████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:09<00:00,  6.45it/s]Traceback (most recent call last):
KeyError: 'f3e4ced27'tprocess_qa_predictions(dataset, dataset_tokenized, main████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:09<00:00,  6.45it/s]Traceback (most recent call last):
KeyError: 'f3e4ced27'tprocess_qa_predictions(dataset, dataset_tokenized, main████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:09<00:00,  6.45it/s]Traceback (most recent call last):