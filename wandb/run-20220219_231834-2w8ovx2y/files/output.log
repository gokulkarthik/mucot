You are adding a <class 'engine.EvaluationCallback'> to the callbacks of this Trainer, but there is already one. The currentlist of callbacks is
:DefaultFlowCallback
WandbCallback
EarlyStoppingCallback
EvaluationCallback
/home/gokul.kumar/.conda/envs/mlqa/lib/python3.9/site-packages/transformers/optimization.py:306: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use thePyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
***** Running training *****
  Num examples = 565
  Num Epochs = 3
  Instantaneous batch size per device = 4
  Total train batch size (w. parallel, distributed & accumulation) = 32
  Gradient Accumulation steps = 8
  Total optimization steps = 51
Automatic Weights & Biases logging enabled, to disable set os.environ["WANDB_DISABLED"] = "true"








 18%|█████████████████████████████████████████████▎                                                                                                                                                                                                                   | 9/51 [00:16<01:15,  1.80s/it]
 20%|██████████████████████████████████████████████████▏                                                                                                                                                                                                             | 10/51 [00:18<01:14,  1.81s/it]***** Running Evaluation *****
  Num examples = 512
  Batch size = 4




 89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 114/128 [00:08<00:01, 13.50it/s]
PyTorch: setting up devices████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:09<00:00, 13.46it/s]
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
The following columns in the test set  don't have a corresponding argument in `BertForQuestionAnswering.forward` and have been ignored: offset_mapping, example_id.
***** Running Prediction *****
  Num examples = 565
  Batch size = 8





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  7.30it/s]
No `TrainingArguments` passed, using `output_dir=tmp_trainer`.███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  7.30it/s]
PyTorch: setting up devices████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                 | 28/30 [00:01<00:00, 19.40it/s]
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
The following columns in the test set  don't have a corresponding argument in `BertForQuestionAnswering.forward` and have been ignored: offset_mapping, example_id.
***** Running Prediction *****
  Num examples = 512
  Batch size = 8
{'jaccard_score': 0.0, 'f1_score': 0.0}




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:09<00:00,  6.51it/s]
Post-processing 30 example predictions split into 512 features.
{'jaccard_score': 0.007625272331154684, 'f1_score': 0.014074074074074076}








 39%|████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                                           | 20/51 [01:10<01:05,  2.11s/it]***** Running Evaluation *****
  Num examples = 512
  Batch size = 4
  0%|                                                                                                                                                                                                                                                                        | 0/128 [00:00<?, ?it/s]




 84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 108/128 [00:08<00:01, 12.80it/s]
PyTorch: setting up devices████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:09<00:00, 13.25it/s]
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
The following columns in the test set  don't have a corresponding argument in `BertForQuestionAnswering.forward` and have been ignored: offset_mapping, example_id.
***** Running Prediction *****
  Num examples = 565
  Batch size = 8





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  7.58it/s]
No `TrainingArguments` passed, using `output_dir=tmp_trainer`.███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  7.58it/s]
PyTorch: setting up devices█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍        | 29/30 [00:01<00:00, 22.84it/s]
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
The following columns in the test set  don't have a corresponding argument in `BertForQuestionAnswering.forward` and have been ignored: offset_mapping, example_id.
***** Running Prediction *****
  Num examples = 512
  Batch size = 8
{'jaccard_score': 0.0, 'f1_score': 0.0}
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:22<00:00, 13.25it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:09<00:00,  6.98it/s]
Post-processing 30 example predictions split into 512 features.
{'jaccard_score': 0.0037037037037037034, 'f1_score': 0.006666666666666667}








 57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                              | 29/51 [02:02<00:55,  2.53s/it]
 59%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                         | 30/51 [02:04<00:48,  2.31s/it]***** Running Evaluation *****
  Num examples = 512
  Batch size = 4




 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████      | 125/128 [00:08<00:00, 12.38it/s]
PyTorch: setting up devices████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:09<00:00, 12.27it/s]
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
The following columns in the test set  don't have a corresponding argument in `BertForQuestionAnswering.forward` and have been ignored: offset_mapping, example_id.
***** Running Prediction *****
  Num examples = 565
  Batch size = 8




 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 70/71 [00:09<00:00,  6.88it/s]
No `TrainingArguments` passed, using `output_dir=tmp_trainer`.███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 70/71 [00:09<00:00,  6.88it/s]
PyTorch: setting up devices█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍        | 29/30 [00:01<00:00, 18.50it/s]
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
The following columns in the test set  don't have a corresponding argument in `BertForQuestionAnswering.forward` and have been ignored: offset_mapping, example_id.
***** Running Prediction *****
  Num examples = 512
  Batch size = 8
  0%|                                                                                                                                                                                                                                                                         | 0/64 [00:00<?, ?it/s]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:09<00:00,  6.75it/s]
Post-processing 30 example predictions split into 512 features.
{'jaccard_score': 0.0, 'f1_score': 0.0}









 78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                       | 40/51 [02:57<00:26,  2.38s/it]
 78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                       | 40/51 [02:57<00:26,  2.38s/it]***** Running Evaluation *****
  Num examples = 512
  Batch size = 4



PyTorch: setting up devices████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:09<00:00, 13.01it/s]
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
The following columns in the test set  don't have a corresponding argument in `BertForQuestionAnswering.forward` and have been ignored: offset_mapping, example_id.
***** Running Prediction *****
  Num examples = 565
  Batch size = 8
  3%|███████▏                                                                                                                                                                                                                                                         | 2/71 [00:00<00:05, 12.95it/s]





 99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 70/71 [00:10<00:00,  6.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  7.44it/s]
 63%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                             | 19/30 [00:00<00:00, 18.01it/s]
PyTorch: setting up devices█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍        | 29/30 [00:01<00:00, 23.14it/s]
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
The following columns in the test set  don't have a corresponding argument in `BertForQuestionAnswering.forward` and have been ignored: offset_mapping, example_id.
***** Running Prediction *****
  Num examples = 512
  Batch size = 8



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 64/64 [00:08<00:00,  6.28it/s]
 27%|████████████████████████████████████████████████████████████████████▌                                                                                                                                                                                            | 8/30 [00:00<00:00, 26.74it/s]
Post-processing 30 example predictions split into 512 features.
{'jaccard_score': 0.0, 'f1_score': 0.0}








 98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉     | 50/51 [03:49<00:02,  2.47s/it]***** Running Evaluation *****
  Batch size = 4 512
  Batch size = 4 512
  7%|██████████████████                                                                                                                                                                                                                                              | 9/128 [00:00<00:08, 13.51it/s]
 29%|█████████████████████████████████████████████████████████████████████████▋                                                                                                                                                                                     | 37/128 [00:02<00:06, 13.01it/s]
 45%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                                             | 57/128 [00:04<00:05, 13.94it/s]
 65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                         | 83/128 [00:06<00:03, 12.88it/s]
 85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                     | 109/128 [00:08<00:01, 13.01it/s]
 85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                     | 109/128 [00:08<00:01, 13.01it/s]
***** Running Prediction *****█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:09<00:00, 12.91it/s]
***** Running Prediction *****█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:09<00:00, 12.91it/s]
***** Running Prediction *****█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:09<00:00, 12.91it/s]
***** Running Prediction *****█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:09<00:00, 12.91it/s]
***** Running Prediction *****█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:09<00:00, 12.91it/s]
***** Running Prediction *****█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:09<00:00, 12.91it/s]
***** Running Prediction *****█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 128/128 [00:09<00:00, 12.91it/s]
 87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                  | 26/30 [00:01<00:00, 23.40it/s]
 87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                  | 26/30 [00:01<00:00, 23.40it/s]
***** Running Prediction *****███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 21.03it/s]
***** Running Prediction *****███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 21.03it/s]
***** Running Prediction *****███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 21.03it/s]
***** Running Prediction *****███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 21.03it/s]
***** Running Prediction *****███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 21.03it/s]
***** Running Prediction *****███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 21.03it/s]
Post-processing 30 example predictions split into 512 features.
{'jaccard_score': 0.0, 'f1_score': 0.0}

{'jaccard_score': 0.0, 'f1_score': 0.0}
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [04:25<00:00, 12.50s/it]
  7%|██████████████████                                                                                                                                                                                                                                               | 5/71 [00:00<00:08,  7.44it/s]
Training completed. Do not forget to share your model on huggingface.co/models =)
  7%|██████████████████                                                                                                                                                                                                                                               | 5/71 [00:00<00:08,  7.44it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [04:25<00:00,  5.20s/it]
No `TrainingArguments` passed, using `output_dir=tmp_trainer`.
  7%|██████████████████                                                                                                                                                                                                                                               | 5/71 [00:00<00:08,  7.44it/s]
The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).
The following columns in the test set  don't have a corresponding argument in `BertForQuestionAnswering.forward` and have been ignored: offset_mapping, example_id.
  7%|██████████████████                                                                                                                                                                                                                                               | 5/71 [00:00<00:08,  7.44it/s]
  Num examples = 565
  Batch size = 8
  7%|██████████████████                                                                                                                                                                                                                                               | 5/71 [00:00<00:08,  7.44it/s]
  7%|██████████████████                                                                                                                                                                                                                                               | 5/71 [00:00<00:08,  7.44it/s]
  7%|██████████████████                                                                                                                                                                                                                                               | 5/71 [00:00<00:08,  7.44it/s]
  7%|██████████████████                                                                                                                                                                                                                                               | 5/71 [00:00<00:08,  7.44it/s]
  7%|██████████████████                                                                                                                                                                                                                                               | 5/71 [00:00<00:08,  7.44it/s]
  7%|██████████████████                                                                                                                                                                                                                                               | 5/71 [00:00<00:08,  7.44it/s]
  7%|██████████████████                                                                                                                                                                                                                                               | 5/71 [00:00<00:08,  7.44it/s]
 25%|████████████████████████████████████████████████████████████████▉                                                                                                                                                                                               | 18/71 [00:02<00:08,  6.56it/s]
 45%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                                                            | 32/71 [00:04<00:05,  6.77it/s]
 63%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                             | 45/71 [00:06<00:03,  6.67it/s]
 83%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                           | 59/71 [00:08<00:01,  6.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  7.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  7.46it/s]
  File "/home/gokul.kumar/Desktop/multilingual-qa/engine.py", line 87, in evaluate_model█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 21.19it/s]
  File "/home/gokul.kumar/Desktop/multilingual-qa/engine.py", line 87, in evaluate_model█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 21.19it/s]
  File "/home/gokul.kumar/Desktop/multilingual-qa/engine.py", line 87, in evaluate_model█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [00:01<00:00, 21.19it/s]